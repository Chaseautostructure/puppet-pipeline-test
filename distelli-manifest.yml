mtlaney/puppet-pipeline-test:
  # Distelli Manifest example
  # PreRelease:
  #   - echo "---Beginning PreRelease---"
  #   - echo "--Installing build dependencies--"
  #   - echo "-Updating apt-get-"
  #   - sudo apt-get -y update
  #   - sudo apt-get -y install curl
  #   - echo "-Installing nodejs-"
  #   - sudo apt-get -y purge nodejs npm
  #   - curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.34.0/install.sh | bash
  #   - nvm install node
  #   - sudo apt-get -y install npm
  #   - echo "--Building--"
  #   - npm install
  #   - echo "--Testing--"

  PkgInclude:
    - '*'

  PkgExclude:
    - node_modules/

  PreBuild:
    - echo "---Begining PreInstall---"
    - echo "--Installing deploy dependencies--"
    - echo "-Updating apt-get-"
    - sudo apt-get -y update
    - sudo apt-get -y install curl
    - echo "-Installing nodejs-"
    - sudo apt-get -y purge nodejs npm
    - curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.34.0/install.sh | bash
    - export NVM_DIR=$HOME/.nvm 
    - . $NVM_DIR/nvm.sh  # This loads nvm
    - nvm install node
    - sudo apt-get -y install npm
    - sudo apt install -y chromium-browser


  Build:
    - echo "Begin Build"
    # - sudo apt-get -y install npm
    - npm install
    
  Env:
    - PORT: '3000'
    
  Exec:
    - /usr/bin/nodejs app.js